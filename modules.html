<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>Examinating - Courses</title>
    <script src="https://raw.githubusercontent.com/mholt/PapaParse/master/papaparse.js"></script>
</head>
<body>
    <div>
        <ul class="site-page-links">
            <li><a  href="index.html" id="MyModules">My Modules</a></li>
            <li><a  href="modules.html" id="All Modules">All Modules</a></li>
            <li><a  href="about.html" id="About">About</a></li>
        </ul>
    </div>
    <div id="options">
        Waiting for Files to be read.
    </div>
    <script>
        
        var MODULE_ID = 0;
        var YEAR_OF_COURSE = 1;
        var MODULE_NAME = 2;
        var LINK = 3;
        var ACADEMIC_YEAR = 4;
        var SEARCH_VALUE = 5;
        var LAST_ACTIVE_MODULE = 1;
        var MODULES = 2;
        var YEARS = 2016-1998;
        
        window.addEventListener('load',function(){ startUp();},false);
        
        var csvRows;
        
        //Code run once the page is loaded.
        var startUp = function(){
            parseData("https://raw.githubusercontent.com/nating/examinating/master/PastPapers.csv", updateData);
            showAllCourses();
        }
        parseData = function(url, callBack) {
            Papa.parse(url,{download: true, dynamicTyping: true, complete: function(results){ callBack(results.data);} });
        }
        updateData = function(parsedFile) {
            csvRows = parsedFile;
        }
        
        var showAllCourses = function(){
            var options = document.getElementById("options");
            options.innerHTML = `
                <ul class="courses">
                    <li id="482">Ancient and Medieval History and Culture</li>
                    <li id="23">Biblical and Theological Studies</li>
                    <li id="481">Business and Computing</li>
                    <li id="80">Business Studies</li>
                    <li id="405">Business Studies and a Language</li>
                    <li id="456">Chemistry with Molecular Modelling</li>
                    <li id="457">Children's and General Nursing (BSc)</li>
                    <li id="5">Classics&nbsp;</li>
                    <li id="37">Clinical Speech and Language Studies</li>
                    <li id="19">Computer Science (B.A.)&nbsp;</li>
                    <li id="412">Computer Science (B.Sc.)</li>
                    <li id="299">Computer Science (Integrated)</li>
                    <li id="57">Computer Science, Linguistics and a Language</li>
                    <li id="503">Deaf Studies (Bachelor)</li>
                    <li id="447">Deaf Studies (Diploma)</li>
                    <li id="406">Dental Hygiene (Diploma)</li>
                    <li id="461">Dental Nursing (Diploma)</li>
                    <li id="67">Dental Science</li>
                    <li id="459">Dental Technology (Bachelor)</li>
                    <li id="27">Drama and Theatre Studies</li>
                    <li id="31">Early and Modern Irish</li>
                    <li id="477">Earth Sciences</li>
                    <li id="46">Economic and Social Studies&nbsp;</li>
                    <li id="98">Education (B.Ed.)</li>
                    <li id="48">English Studies</li>
                    <li id="70">Engineering</li>
                    <li id="280">Engineering (Integrated)</li>
                    <li id="450">Engineering Double Diplome</li>
                    <li id="464">Engineering with Management</li>
                    <li id="287">Engineering with Management (Integrated)</li>
                    <li id="53">European Studies</li>
                    <li id="445">European Studies Double Diploma</li>
                    <li id="432">Foundation Course for Higher Education - Mature Students</li>
                    <li id="437">Foundation Course for Higher Education - Young Adults</li>
                    <li id="49">Germanic Languages</li>
                    <li id="40">History</li>
                    <li id="97">History of European Painting (Diploma)</li>
                    <li id="26">History and Political Science</li>
                    <li id="420">Human Genetics</li>
                    <li id="476">Human Health and Disease</li>
                    <li id="453">Information Systems (Diploma) </li>
                    <li id="454">Information Systems (BSc Hons) </li>
                    <li id="463">Irish Studies</li>
                    <li id="51">Law</li>
                    <li id="408">Law and French</li>
                    <li id="409">Law and German</li>
                    <li id="478">Law and Business</li>
                    <li id="479">Law and Political Science</li>
                    <li id="18">Management Science and Information Systems Studies (MSISS)</li>
                    <li id="439">Manufacturing Engineering with Management Science (MEMS)</li>
                    <li id="89">Mathematics</li>
                    <li id="66">Medicine</li>
                    <li id="455">Medicine (5-year)</li>
                    <li id="436">Medicinal Chemistry</li>
                    <li id="6">Mental and Moral Science</li>
                    <li id="458">Midwifery (BSc)</li>
                    <li id="448">Midwifery Studies (Bachelor)</li>
                    <li id="41">Music</li>
                    <li id="55">Music Education (B.Ed.)</li>
                    <li id="15">Natural Sciences</li>
                    <li id="446">Nursing Studies (BSc)</li>
                    <li id="444">Nursing Studies (October intake)</li>
                    <li id="54">Occupational Therapy</li>
                    <li id="59">Pharmaceutical Technicians (Diploma)</li>
                    <li id="16">Pharmacy</li>
                    <li id="472">Philosophy</li>
                    <li id="414">Philosophy and Political Science</li>
                    <li id="470">Philosophy, Political Science, Economics and Sociology</li>
                    <li id="440">Physics and Chemistry of Advanced Materials</li>
                    <li id="17">Physiotherapy</li>
                    <li id="480">Political Science and Geography</li>
                    <li id="12">Psychology</li>
                    <li id="451">Radiation Therapy</li>
                    <li id="462">Religions and Theology</li>
                    <li id="85">Social Studies&nbsp;</li>
                    <li id="413">Sociology and Social Policy</li>
                    <li id="52">Theology</li>
                    <li id="404">Theoretical Physics</li>
                    <li id="84">World Religions and Theology (New Course 2010/11)</li>
                    <li id="706">Applied Building Repair and Conservation (PG Diploma)</li>
                    <li id="743">Applied Psychology (M.Sc)</li>
                    <li id="110">Business Administration (Masters)</li>
                    <li id="794">Business Administration (PT) (Masters)</li>
                    <li id="694">Business and Management (M.Sc)</li>
                    <li id="802">Cancer Care (M.Sc)</li>
                    <li id="676">Cardiac Rehabilitation (M.Sc)</li>
                    <li id="224">Child and Adolescent Analytic Psychotherapy (M.Sc)</li>
                    <li id="755">Children's Nursing(RCN) (Higher Diploma)</li>
                    <li id="211">Civil Engineering (old course) (M.Sc)</li>
                    <li id="525">Civil Engineering (new course) (M.Sc)</li>
                    <li id="778">Classics (Master in Philosophy)</li>
                    <li id="629">Clinical Practice (PG Diploma)</li>
                    <li id="609">Cognitive Psychotherapy (M.Sc)</li>
                    <li id="612">Cognitive Psychotherapy (PG Diploma)</li>
                    <li id="569">Comparative European Politics (PT) (M.Sc)</li>
                    <li id="619">Computer Science (Networks and Distributed Systems)(M.Sc)</li>
                    <li id="739">Computer Science (Mobile and Ubiquitous Computing)(M.Sc)</li>
                    <li id="769">Computer Science (Interactive Entertainment Technology)(M.Sc)</li>
                    <li id="702">Computer Science (Ubiqutous Computing) (Master)</li>
                    <li id="130">Computers for Engineers (PG Diploma)</li>
                    <li id="805">Computing with Advanced Interdisciplinary Outlook (PG Diploma)</li>
                    <li id="807">Computing (Conversion) with Advanced Interdisciplinary Outlook (PG Diploma)</li>
                    <li id="614">Construction Law and Contract Administration (PG Diploma)</li>
                    <li id="622">Dental Surgery (Master)</li>
                    <li id="628">Early Irish (Master in Philosophy)</li>
                    <li id="645">Economic Policy (M.Sc)</li>
                    <li id="601">Education (Primary Teaching - Higher Diploma)</li>
                    <li id="762">Education (PG Diploma)</li>
                    <li id="201">Environmental Engineering (PG Diploma)</li>
                    <li id="799">Exercise Physiology (MSc)</li>
                    <li id="566">Finance (FT) (MSc)</li>
                    <li id="567">Finance (PT) (MSc)</li>
                    <li id="637">Fire Safety Practice (PG Diploma)</li>
                    <li id="248">German Language Literature and Language (Master in Philosophy)</li>
                    <li id="705">Health and Safety in Construction (PG Diploma)</li>
                    <li id="616">Health Informatics (PG Piploma)</li>
                    <li id="626">High Performance Computing (M.Sc)</li>
                    <li id="186">Highway and Geotechnical Engineering (PG Diploma)</li>
                    <li id="781">Interactive Digital Media (M.Sc)</li>
                    <li id="792">International Management (Masters)</li>
                    <li id="607">LLM (Master in Laws)</li>
                    <li id="700">Management Information Systems (M.Sc)</li>
                    <li id="733">Mechanical Engineering (Erasmus Mundus - M.Sc)</li>
                    <li id="438">Midwifery (PG Diploma)</li>
                    <li id="605">Midwifery (M.Sc)</li>
                    <li id="767">Midwifery (Higher Diploma)</li>
                    <li id="263">Multimedia Systems (M.Sc)</li>
                    <li id="604">Nursing (M.Sc)</li>
                    <li id="421">Nursing Studies (PG Diploma)</li>
                    <li id="627">Old Irish (PG Diploma)</li>
                    <li id="264">Paediatrics (M.Sc)</li>
                    <li id="633">Pharmaceutical Analysis (M.Sc) (98/99-06/07)</li>
                    <li id="544">Pharmaceutical Analysis (M.Sc) (07/08-10/11)</li>
                    <li id="210">Physical Planning for Engineers (PG Diploma)</li>
                    <li id="136">Project Management (PG Diploma)</li>
                    <li id="720">Psychology (Higher Diploma) </li>
                    <li id="272">Quality Improvement (PG Diploma)</li>
                    <li id="669">Social Work (Masters)</li>
                    <li id="649">Specialist Nursing (PG Diploma)</li>
                    <li id="689">Specialist Nursing (M.Sc)</li>
                    <li id="08">Sports Medicine (M.Sc )</li>
                    <li id="129">Statistics (PG Diploma)</li>
                </ul>`;
            makeCoursesClickable();
        }
        
        var makeCoursesClickable = function() {
            var links = document.getElementsByTagName('li');
            for(var i=0;i<links.length;i++) {
                var link = links[i];
                if(link.parentElement.getAttribute('class') == 'courses') {
                    link.setAttribute("onclick","showYearsOfCourse("+link.getAttribute('id')+");");
                }
            }
        }
        
        var makeYearsClickable = function() {
            var links = document.getElementsByTagName('li');
            for(var i=0;i<links.length;i++) {
                var link = links[i];
                if(link.parentElement.getAttribute('class') == 'years') {
                    link.setAttribute("onclick","showModulesOfYear("+link.getAttribute('id')+");");
                }
            }
        }
        
        //Needs to be edited to show all _years in a course_ not _all years in a school_
        var showYearsOfCourse = function(listElement){
                console.log("I'm here x");
            var listOfYears = "<a href=\"modules.html\"><-- All Courses</a><ul class=\"years\">";
            var searchValue = listElement;
            //var index = getCourseIndex(csvRows,searchValue);
            var currentYear = 1;
            while(currentYear<7){
                console.log("Now checking with currentYear="+currentYear);
                var index = 0;
                while(index<csvRows.length){
                    /*if(csvRows[index][SEARCH_VALUE]==searchValue && csvRows[index][ACADEMIC_YEAR]==currentYear){
                        listOfYears += "<li id=\""+csvRows[index][MODULE_ID]+searchValue+"\">"+csvRows[index][MODULE_NAME]+csvRows[index][ACADEMIC_YEAR]+"</li>";
                    }*/
                    if(csvRows[index][MODULE_ID]=="CS4LL5"){
                        console.log(csvRows[index][MODULE_ID]+" "+csvRows[index][ACADEMIC_YEAR]+" "+csvRows[index][SEARCH_VALUE]);
                    }
                    
                    if(csvRows[index][ACADEMIC_YEAR]==currentYear && csvRows[index][SEARCH_VALUE]==searchValue){
                        if(csvRows[index][ACADEMIC_YEAR]==1){
                            listOfYears += "<li id=\""+csvRows[index][ACADEMIC_YEAR]+searchValue+"\">1st year</li>";
                            break;}
                        else if(csvRows[index][ACADEMIC_YEAR]==2){
                            listOfYears += "<li id=\""+csvRows[index][ACADEMIC_YEAR]+searchValue+"\">2nd year</li>";
                            break;}
                        else if(csvRows[index][ACADEMIC_YEAR]==3){
                            listOfYears += "<li id=\""+csvRows[index][ACADEMIC_YEAR]+searchValue+"\">3rd year</li>";
                            break;}
                        else{
                            listOfYears += "<li id=\""+csvRows[index][ACADEMIC_YEAR]+searchValue+"\">"+csvRows[index][ACADEMIC_YEAR]+"th year</li>";
                            break;}
                    }
                    index++;
                }
                currentYear++;
            }
            listOfYears += "</ul><div id=\"modulesOfTheYear\"></div>"

            var options = document.getElementById("options");
            options.innerHTML = listOfYears;
            makeYearsClickable();
        }
        
        //Needs to be edited to show all modules in a year of a _course_ not a _school_
        var showModulesOfYear = function(listElement){
            var listOfModules = "<ul id=\"modules\">";
            listElementString = ""+listElement;
            var addedModules = [];
            var yearOfCourse = listElementString.substring(0,1);// <------    
            var searchValue = listElementString.substring(1,listElementString.length);
            /*var index = getModuleCodeIndex(csvRows,searchValue);*/
            for(var i=0;i<csvRows.length;i++){
                if(csvRows[i][SEARCH_VALUE]==searchValue && csvRows[i][ACADEMIC_YEAR]==yearOfCourse){
                    var alreadyAdded = false;
                    for(var j=0;j<addedModules.length;j++){
                        if(addedModules[j]==csvRows[i][MODULE_ID]){
                            alreadyAdded = true; break;
                        }
                    }
                    if(!alreadyAdded){
                        listOfModules += "<li id=\""+csvRows[i][MODULE_ID]+"\">"+csvRows[i][MODULE_ID]+" "+csvRows[i][MODULE_NAME]+"</li>";
                        addedModules.push(csvRows[i][MODULE_ID]);
                    }
                }
            }
            /*if(csvRows[index][ACADEMIC_YEAR]==yearOfCourse){ listOfModules += "<li id=\""+csvRows[index][MODULE_ID]+"\">"+csvRows[index][MODULE_NAME]+"</li>"; }
            var lastModuleAdded = csvRows[index][MODULE_ID];
            index++;
            while(csvRows[index][MODULE_ID].indexOf(courseCode)==0){
                if(csvRows[index][MODULE_ID]!=lastModuleAdded && csvRows[index][ACADEMIC_YEAR]==yearOfCourse){
                    listOfModules += "<li id=\""+csvRows[index][MODULE_ID]+"\">"+csvRows[index][MODULE_NAME]+"</li>"
                    lastModuleAdded = csvRows[index][MODULE_ID];
                }
                index++;
            }*/
            listOfModules += "</ul>"

            var modulesOfTheYear = document.getElementById("modulesOfTheYear");
            modulesOfTheYear.innerHTML = listOfModules;
        }
        
        
        //Binary search data for a course. (data being sorted by courseCode)
        var getModuleCodeIndex = function(data,courseCode){
            
            var low = 0;
            var high = data.length-1;
            var centre;
            var courseCodeAtCentre;
            
            while(low<=high){
                centre = Math.round((low+high)/2);
                courseCodeAtCentre = data[centre][MODULE_CODE].substring(0,2);
                if(courseCodeAtCentre==courseCode){
                    while(centre!=0 && data[centre-1][MODULE_CODE].substring(0,2)==courseCode){
                        centre--;
                    }
                    return centre;
                }
                else if(courseCodeAtCentre < courseCode){
                    low = centre+1;
                }
                if(courseCodeAtCentre > courseCode){
                    high = centre-1;
                }
            }
            console.log("No link was found for the courseCode: "+courseCode);
            return -1;
        };
        
        
        //Binary search data for a course. (data being sorted by searchValue)
        var getCourseIndex = function(data,searchValue){
            
            var low = 0;
            var high = data.length-1;
            var centre;
            var valAtCentre;
            
            while(low<=high){
                centre = Math.round((low+high)/2);
                valAtCentre = data[centre][SEARCH_VALUE];
                if(valAtCentre==searchValue){
                    while(centre!=0 && data[centre-1][SEARCH_VALUE]==searchValue){
                        centre--;
                    }
                    return centre;
                }
                else if(valAtCentre < searchValue){
                    low = centre+1;
                }
                if(valAtCentre > searchValue){
                    high = centre-1;
                }
            }
            console.log("No link was found for the searchValue: "+searchValue);
            return -1;
        };
        
                    /*<li id="AN">AN Anatomy</li>
                    <li id="AP">AP Foundation Course for Higher Education</li>
                    <li id="BI">BI Biochemistry &amp; Immunology</li>
                    <li id="BO">BO Botany</li>
                    <li id="BU">BU Business Studies</li>
                    <li id="BY">BY Biology</li>
                    <li id="CE">CE Civil Structural &amp; Enviromental Engineering</li>
                    <li id="CH">CH Chemistry</li>
                    <li id="CL">CL Classics</li>
                    <li id="CS">CS Computer Science</li>
                    <li id="DE">DE Dental Studies</li>
                    <li id="DF">DF Deaf Studies</li>
                    <li id="DR">DR Drama</li>
                    <li id="EC">EC Economics</a></li>
                    <li id="EE">EE Electrical &amp; Electronic Engineering</li>
                    <li id="EN">EN English</li>
                    <li id="ES">ES Enviromental Science</li>
                    <li id="ET">ET Music Education</li>
                    <li id="FB">FB Functional Biology</li>
                    <li id="FR">FR French</li>
                    <li id="GE">GE Genetics &amp; Microbiology</li>
                    <li id="GG">GG Geography</li>
                    <li id="GL">GL Geology</li>
                    <li id="GR">GR German</li>
                    <li id="HA">HA History of Art</li>
                    <li id="HE">HE Religions &amp; Theology</li>
                    <li id="HH">HH Histories &amp; Humanitaries</li>
                    <li id="HI">HI History</li>
                    <li id="IE">IE Imagining Ireland</li>
                    <li id="IR">IR Irish Studies</li>
                    <li id="IT">IT Italian</li>
                    <li id="LA">LA Law</li>
                    <li id="LI">LI Linguistics</li>
                    <li id="LY">LY Loyola Institute</li>
                    <li id="MA">MA Mathematics</li>
                    <li id="MD">MD Medicine</li>
                    <li id="ME">ME Mechanical &amp; Manufactural Engineering</li>
                    <li id="MI">MI Microbiology</li>
                    <li id="MU">MU Music</li>
                    <li id="MW">MW Midwifery</a></li>
                    <li id="NM">NM Near &amp; Middle Eastern Studies</li>
                    <li id="NU">NU Nursing</a></li>
                    <li id="OT">OT Occupational Therapy</li>
                    <li id="PG">PG Physiology</li>
                    <li id="PH">PH Pharmacy</li>
                    <li id="PI">PI Phisiology</li>
                    <li id="PL">PL Polish</li>
                    <li id="PO">PO Political Science</li>
                    <li id="PR">PR Psychiatry</li>
                    <li id="PS">PS Psychology</li>
                    <li id="PT">PT Physiotherapy</li>
                    <li id="PY">PY Physics</li>
                    <li id="RT">RT Radiotherapy</li>
                    <li id="RU">RU Russian &amp; Slavonic Studies</li>
                    <li id="SL">SL Clinical Speech &amp; Language Studies</li>
                    <li id="SO">SO Sociology</li>
                    <li id="SP">SP Hispanic Studies</li>
                    <li id="SS">SS Social Work &amp; Social Policy</li>
                    <li id="ST">ST Statistics</li>
                    <li id="ZO">ZO Zoology</li>*/
        
    </script>
</body>
